
1.	Downloading Fasta sequence from http and renaming file
$wget  https://ftp.ncbi.nlm.nih.gov/genomes/all/GCA/001/298/445/GCA_001298445.1_ASM129844v1/ GCA_001298445.1_ASM129844v1_cds_from_genomic.fna.gz

$tar zxvpf GCA_001298445.1_ASM129844v1_cds_from_genomic.fna.gz

$mv /home/dube_02/GCA_001298445.1_ASM129844v1_cds_from_genomic.fna.gz /home/dube_02/Nostoc_piscinale_CENA21

Similar procedure to be followed for another sequence:
$wget https://ftp.ncbi.nlm.nih.gov/genomes/all/GCA/002/368/155/GCA_002368155.1_ASM236815v1/ GCA_002368155.1_ASM236815v1_cds_from_genomic.fna.gz

$tar zxvf GCA_002368155.1_ASM236815v1_cds_from_genomic.fna.gz

$mv /home/dube_02/ GCA_002368155.1_ASM236815v1_cds_from_genomic.fna.gz  /home/dube_02/Nostoc_carneum_NIES_2107

2.	As mentioned in the question small size fasta file (query sequence) to be taken. 
100 sequences are extracted from the query fasta file downloaded from genbank (1)

$grep -e ">" Nostoc_carneum_NIES_2107.fna | head -100| sed 's/>//g' >seqids.txt
$awk -F'>' 'NR==FNR{ids[$0]; next} NF>1{f=($2 in ids)} f' seqids.txt Nostoc_carneum_NIES_2107 > Nostoc_carneum_100seq

3.	Create a database from the downloaded sequences (i.e reference and query sequences)


$./makeblastdb -in /home/dube_02/Nostoc_carneum_100seq -dbtype nucl  
$./makeblastdb -in /home/dube_02/Nostoc_piscinale_CENA21.fna -dbtype nucl

4.	Search for homologous sequences (for query sequences) in the reference database  using blastn program.

$ ./blastn -query /home/dube_02/Nostoc_carneum_100seq -subject   
                /home/dube_02/Nostoc_piscinale_CENA21.fna -evalue 1E-5 -out 
                 Nostoc_piscinale_db_carneum_query -outfmt “6 sseqid qseqid pident length mismatch   
                 gapopen qstart qend sstart send evalue bitscore”




            For reciprocal blast hit, interchange subject and query fasta files.
               $./blastn -subject /home/dube_02/Nostoc_carneum_100seq -query     
                /home/dube_02/Nostoc_piscinale_CENA21.fna -evalue 1E-5 -out    
                 Nostoc_piscinale_query_carneum_db -outfmt “6 qseqid sseqid pident length mismatch   
                 gapopen qstart qend sstart send evalue bitscore

5.	Format blast results :

$ sed -i 's/\tlcl//g'  carneum_db_piscinale_query
$ sed -i 's/\tlcl//g'  carneum_query_piscinale_db

6.	Compare two blast results to get reciprocal blast hits

$awk 'NR==FNR{a[$1,$1];next} ($1,$1) in a' carneum_db_piscinale_query carneum_query_piscinale_db |cut -f1|sort|uniq > rbh_result


7.	Add header to the reciprocal blast hits

$sed -e '1i\qseqid|sseqid\tpident\tlength\tmismatch\tgapopen\tqstart\tqend\tsstart\tsend\tevalue\tbitscore' rbh_result > reciprocal_blast_hit

Note: Directly go to /home_directory/ncbi-blast-2.2.30+/bin and run blast programs as mentioned above (for blastn program use ./blast ..command)

